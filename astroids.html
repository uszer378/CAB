<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Asteroids Game</title>
  <style>
    html, body {
      margin: 0;
      overflow: hidden;
      background: black;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const keys = {};
const bullets = [];
const asteroids = [];

let gameOver = false;

const ship = {
  x: canvas.width / 2,
  y: canvas.height / 2,
  angle: 0,
  vx: 0,
  vy: 0,
  radius: 15
};

document.addEventListener("keydown", (e) => {
  keys[e.code] = true;
  if (e.code === "Space" && !gameOver) shoot();
});
document.addEventListener("keyup", (e) => {
  keys[e.code] = false;
});

function shoot() {
  bullets.push({
    x: ship.x + Math.cos(ship.angle) * 20,
    y: ship.y + Math.sin(ship.angle) * 20,
    vx: Math.cos(ship.angle) * 6,
    vy: Math.sin(ship.angle) * 6,
    life: 60
  });
}

function createAsteroid(x = null, y = null, size = 50) {
  const angle = Math.random() * Math.PI * 2;
  const speed = 1 + Math.random();
  asteroids.push({
    x: x ?? Math.random() * canvas.width,
    y: y ?? Math.random() * canvas.height,
    vx: Math.cos(angle) * speed,
    vy: Math.sin(angle) * speed,
    size: size
  });
}

for (let i = 0; i < 5; i++) createAsteroid();

function drawShip() {
  ctx.save();
  ctx.translate(ship.x, ship.y);
  ctx.rotate(ship.angle);
  ctx.beginPath();
  ctx.moveTo(20, 0);
  ctx.lineTo(-15, -10);
  ctx.lineTo(-10, 0);
  ctx.lineTo(-15, 10);
  ctx.closePath();
  ctx.strokeStyle = "white";
  ctx.stroke();
  ctx.restore();
}

function wrap(obj) {
  if (obj.x < 0) obj.x = canvas.width;
  if (obj.x > canvas.width) obj.x = 0;
  if (obj.y < 0) obj.y = canvas.height;
  if (obj.y > canvas.height) obj.y = 0;
}

function update() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  if (gameOver) {
    ctx.fillStyle = "white";
    ctx.font = "48px sans-serif";
    ctx.textAlign = "center";
    ctx.fillText("GAME OVER", canvas.width / 2, canvas.height / 2);
    return;
  }

  // Controls
  if (keys["ArrowLeft"]) ship.angle -= 0.07;
  if (keys["ArrowRight"]) ship.angle += 0.07;
  if (keys["ArrowUp"]) {
    ship.vx += Math.cos(ship.angle) * 0.1;
    ship.vy += Math.sin(ship.angle) * 0.1;
  }

  // Move ship
  ship.x += ship.vx;
  ship.y += ship.vy;
  wrap(ship);
  drawShip();

  // Bullets
  for (let i = bullets.length - 1; i >= 0; i--) {
    const b = bullets[i];
    b.x += b.vx;
    b.y += b.vy;
    b.life--;
    wrap(b);
    if (b.life <= 0) bullets.splice(i, 1);
    else {
      ctx.beginPath();
      ctx.arc(b.x, b.y, 3, 0, Math.PI * 2);
      ctx.fillStyle = "white";
      ctx.fill();
    }
  }

  // Asteroids
  for (let i = asteroids.length - 1; i >= 0; i--) {
    const a = asteroids[i];
    a.x += a.vx;
    a.y += a.vy;
    wrap(a);

    // Draw asteroid
    ctx.beginPath();
    ctx.arc(a.x, a.y, a.size / 2, 0, Math.PI * 2);
    ctx.strokeStyle = "gray";
    ctx.stroke();

    // Check collision with ship
    const dx = ship.x - a.x;
    const dy = ship.y - a.y;
    const dist = Math.hypot(dx, dy);
    if (dist < a.size / 2 + ship.radius) {
      gameOver = true;
    }

    // Bullet collisions
    for (let j = bullets.length - 1; j >= 0; j--) {
      const b = bullets[j];
      const bx = b.x - a.x;
      const by = b.y - a.y;
      if (Math.hypot(bx, by) < a.size / 2) {
        bullets.splice(j, 1);
        if (a.size > 20) {
          createAsteroid(a.x, a.y, a.size / 2);
          createAsteroid(a.x, a.y, a.size / 2);
        }
        asteroids.splice(i, 1);
        break;
      }
    }
  }

  requestAnimationFrame(update);
}

update();
</script>
</body>
</html>
